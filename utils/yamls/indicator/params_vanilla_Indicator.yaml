### General Setting
# resumed_model: Dec.18_21.54.38/saved_model_global_model_1200.pt.tar
# resumed_model: Jan.18_02.45.02/saved_model_global_model_400.pt.tar #EMNIST 0.5
# resumed_model: Jan.18_02.44.47/saved_model_global_model_1200.pt.tar #CIFAR100
# resumed_model: Feb.04_12.32.37/saved_model_global_model_1200.pt.tar #CIFAR100 0.5
resumed_model: Feb.04_12.32.37/saved_model_global_model_1200.pt.tar #CIFAR100 0.9
# resumed_model: Jan.14_15.30.56/saved_model_global_model_1200.pt.tar #alpha 0.5
# resumed_model: Jan.14_15.31.22/saved_model_global_model_1200.pt.tar #alpha 0.9
# resumed_model: Jan.20_16.07.45/saved_model_global_model_1200.pt.tar #VGG16
# resumed_model: Jan.20_15.32.54/saved_model_global_model_1200.pt.tar #ResNet34
# resumed_model: False

# save_on_round: [400, 500, 600, 800, 1000, 1200, 1500, 1800]
save_on_round: [10000]

### watermark setting
noise_rate: 0.5
noise_pattern: 1
noise_label_fixed: True
ood_data_sample_lens: 800 #2000 for emnist
ood_data_batch_size: 64
ood_data_source: CIFAR10 #300KRANDOM or NOISE

### Benign Client Setting
# Optimizer Setting
benign_lr: 0.1 #0.1
benign_momentum: 0.9
benign_weight_decay: 0.0005 #0.0005

# Training Process Setting
benign_is_projection_grad: False
benign_projection_norm: 3
benign_retrain_no_times: 2 #7

### Malicious Client Setting
# Optimizer Setting
poisoned_lr: 0.01 #0.1 400, 0.05 800, 0.02 100
# poisoned_lr: 0.05 #0.1 400, 0.05 800, 0.02 100
# poisoned_lr: 0.04 #0.1 400, 0.05 800, 0.02 100
poisoned_momentum: 0.9
poisoned_weight_decay: 0.0005

# Training Process Setting
poisoned_is_projection_grad: False
poisoned_projection_norm: 5
poisoned_retrain_no_times: 10
# poisoned_start_round: 410
# poisoned_start_round: 810
poisoned_start_round: 1210
poisoned_end_round: 13000
poisoned_round_interval: 1

adaptive_attack: False
adaptive_attack_round: 10
adaptive_attack_lr: 0.05

# Poisoned Task Setting
poison_task_name: "pixel pattern"

# semantic: True
# pixel_pattern: False

edge_case: False
# edge_case: True

semantic: False
pixel_pattern: True

# car with stripe bg 14
poison_images_test:
  - 330
  - 3934
  - 12336
  - 30560
  - 30696

poison_images:
  - 568
  - 33105
  - 33615
  - 33907
  - 36848
  - 40713
  - 41706

poisoned_original_class: 1
poisoned_pattern_choose: 1
blend_alpha: 0.3
poison_label_swap: 2 #8 for green car
poisoned_len: 7 #4

poison_no_reuse: 10
poison_train_batch_size: 64

### Server Setting
# dataset&model setting
agg_method: FedProx
defense_method: Indicator
malicious_train_algo: Vanilla
Fedprox_mu: 0 #0.5
watermarking_mu: 0.1 #100
watermarking_mu_reduce_by: 0 #0.003
watermarking_mu_add_by: 0 #0.02
watermarking_cs: 0 #0.04
ood_noise_percent: 0.2
ood_noise_scale: 1.5
model_type: ResNet18
dataset: CIFAR100 #EMNIST
class_num: 100 #100

sample_dirichlet: True
dirichlet_alpha: 0.9

# server training setting
start_round: 1
end_round: 1900
train_batch_size: 64
test_batch_size: 1000
no_of_total_participants: 100
no_of_participants_per_round: 10
no_of_adversaries: 1

# norm clipping setting
norm_clip: False
fix_nc_bound: True
nc_bound: 2
check_clipped_norm: 100

# aggregation setting
eta: 0.5

# global dataset setting
global_dataset_size: 200
global_no_reuse: 1 #actual dataloader size= * \times global_data_batch_size
global_data_batch_size: 200
global_data_train_batch_size: 200
global_class_num: 20

global_retrain_no_times: 50 #100

# global optimizer setting
global_lr_add_by: 0.001 #0.001
global_lr_init: 0.0008 #0.001
global_lr_max: 0.0008 #0.008
global_momentum: 0.9 #0.9
global_weight_decay: 0.0005
global_is_projection_grad: False
global_projection_norm: 0.8
# global_watermarking_start_round: 11000
global_watermarking_start_round: 100
global_watermarking_end_round: 13000
global_watermarking_round_interval: 1
global_milestones:
  - 10
  - 20
  - 30
  - 160
  - 200
  - 240
  - 280
  - 320
  - 360
global_lr_gamma: 0.8 #0.8 for green car

malicious_milestones:
  - 2
  - 4
  - 6
  - 8
malicious_lr_gamma: 0.3 #0.6 for green car 0.4

adaptive_malicious_milestones:
  - 10
  - 20
  - 30
  - 40
adaptive_malicious_lr_gamma: 1 #0.6 for green car 0.4

benign_milestones:
  - 2
  - 4
  - 6
  - 8
benign_lr_gamma: 0.1 #0.2 0.4

malicious_neurotoxin_ratio: 1
malicious_aggregate_all_layer: 1

### logging setting
show_local_test_log: False
show_train_log: False

aggregate_all_layer: 1
partial_watermarking_ratio: 1 #0.99 [0.1, 0.5]

regulation_method: l2_norm+neurotoxin
# regulation_method: ewc
ewc_lambda: 0

### VWM detection setting
VWM_detection_threshold_initial: 85
VWM_detection_threshold_min: 85
VWM_detection_threshold_minus_on: 0

replace_original_bn: True